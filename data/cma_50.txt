(tensor) (base) yuzhou@Yuzhous-MacBook-Pro-8 bayesian_opt_multi_dynamic % python multi_dynamic_main.py opt_demo_model
pybullet build time: Nov  5 2024 13:54:07

=== Load the model and run the demo with bayes optimization===
argv[0]=--opengl2
/Users/yuzhou/Desktop/bayesian_opt_multi_dynamic/optimizer/panda_pushing_optimizer.py:252: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  self._dynamics_model.load_state_dict(torch.load(BOX_MULTI_RESIDUAL_MODEL))
Testing box pushing optimizer with fixed target for 50 epochs
target state:  [ 0.95 -0.1   0.  ]
Angle offset between intermediate and target object:  -0.26333764854816916
goal dist:  0.07016931517925247
--------------------------------------------------
COST: 1.2702
STEP: 12
GOAL: True
MIN COST: 1.2702
PARAM: ['0.0535', '0.7159', '0.8855', '0.1215']
target state:  [ 0.95 -0.1   0.  ]
Angle offset between intermediate and target object:  0.49368670892457994
goal dist:  0.09794806296783905
--------------------------------------------------
COST: 1.4979
STEP: 14
GOAL: True
target state:  [ 0.95 -0.1   0.  ]
Angle offset between intermediate and target object:  0.3558274370962165
goal dist:  0.12712720024095772
--------------------------------------------------
COST: 11.6271
STEP: 15
GOAL: False
target state:  [ 0.95 -0.1   0.  ]
Angle offset between intermediate and target object:  -0.2600177907795103
goal dist:  0.0999177601690557
--------------------------------------------------
COST: 1.0999
STEP: 10
GOAL: True
MIN COST: 1.0999
PARAM: ['0.0535', '0.7159', '0.8855', '0.1215']
target state:  [ 0.95 -0.1   0.  ]
Angle offset between intermediate and target object:  -0.32772556968374206
goal dist:  0.08767844724473899
--------------------------------------------------
COST: 1.5877
STEP: 15
GOAL: True
target state:  [ 0.95 -0.1   0.  ]
Angle offset between intermediate and target object:  0.09636337960567286
goal dist:  0.07094597462687607
--------------------------------------------------
COST: 1.3709
STEP: 13
GOAL: True
target state:  [ 0.95 -0.1   0.  ]
Angle offset between intermediate and target object:  0.00529411261665974
goal dist:  0.15560333993467718
--------------------------------------------------
COST: 11.7556
STEP: 16
GOAL: False
target state:  [ 0.95 -0.1   0.  ]
Angle offset between intermediate and target object:  -0.2853952935645786
goal dist:  0.09531030240965553
--------------------------------------------------
COST: 1.2953
STEP: 12
GOAL: True
target state:  [ 0.95 -0.1   0.  ]
Angle offset between intermediate and target object:  -0.2805093382126965
goal dist:  0.09519752621387163
--------------------------------------------------
COST: 1.2952
STEP: 12
GOAL: True
target state:  [ 0.95 -0.1   0.  ]
Angle offset between intermediate and target object:  0.010548464833521768
goal dist:  0.0963089396438505
--------------------------------------------------
COST: 1.3963
STEP: 13
GOAL: True
target state:  [ 0.95 -0.1   0.  ]
Angle offset between intermediate and target object:  0.37028766406441677
goal dist:  0.10840361207889831
--------------------------------------------------
COST: 1.5084
STEP: 14
GOAL: True
target state:  [ 0.95 -0.1   0.  ]
Angle offset between intermediate and target object:  -0.33611083554121896
goal dist:  0.0958365776449782
--------------------------------------------------
COST: 1.1958
STEP: 11
GOAL: True
target state:  [ 0.95 -0.1   0.  ]
Angle offset between intermediate and target object:  -0.2768719737676395
goal dist:  0.0876381691588658
--------------------------------------------------
COST: 1.1876
STEP: 11
GOAL: True
target state:  [ 0.95 -0.1   0.  ]
Angle offset between intermediate and target object:  0.14367478115080728
goal dist:  0.09870853515792968
--------------------------------------------------
COST: 1.2987
STEP: 12
GOAL: True
target state:  [ 0.95 -0.1   0.  ]
Angle offset between intermediate and target object:  -0.18993423210672908
goal dist:  0.07321092345107862
--------------------------------------------------
COST: 1.2732
STEP: 12
GOAL: True
target state:  [ 0.95 -0.1   0.  ]
Angle offset between intermediate and target object:  -0.49593621177676067
goal dist:  0.09377453886479306
--------------------------------------------------
COST: 1.1938
STEP: 11
GOAL: True
target state:  [ 0.95 -0.1   0.  ]
Angle offset between intermediate and target object:  0.449222265037773
detached, done with this trajectory
goal dist:  0.23182342511085022
--------------------------------------------------
COST: 11.8318
STEP: 16
GOAL: False
target state:  [ 0.95 -0.1   0.  ]
Angle offset between intermediate and target object:  -0.15497486793546084
goal dist:  0.10105121687235205
--------------------------------------------------
COST: 1.2011
STEP: 11
GOAL: True
target state:  [ 0.95 -0.1   0.  ]
Angle offset between intermediate and target object:  0.5189028987761851
goal dist:  0.09518730120628113
--------------------------------------------------
COST: 1.8952
STEP: 18
GOAL: True
target state:  [ 0.95 -0.1   0.  ]
Angle offset between intermediate and target object:  -0.022268290738509902
goal dist:  0.09613985177442003
--------------------------------------------------
COST: 1.0961
STEP: 10
GOAL: True
MIN COST: 1.0961
PARAM: ['0.0535', '0.7159', '0.8855', '0.1215']
target state:  [ 0.95 -0.1   0.  ]
Angle offset between intermediate and target object:  0.06308483049314419
goal dist:  0.08678830891968393
--------------------------------------------------
COST: 1.0868
STEP: 10
GOAL: True
MIN COST: 1.0868
PARAM: ['0.0535', '0.7159', '0.8855', '0.1215']
target state:  [ 0.95 -0.1   0.  ]
Angle offset between intermediate and target object:  0.4188061865015631
detached, done with this trajectory
goal dist:  0.20023611784654655
--------------------------------------------------
COST: 12.0002
STEP: 18
GOAL: False
target state:  [ 0.95 -0.1   0.  ]
Angle offset between intermediate and target object:  0.45885614790883794
detached, done with this trajectory
goal dist:  0.3300411456531003
--------------------------------------------------
COST: 11.5300
STEP: 12
GOAL: False
target state:  [ 0.95 -0.1   0.  ]
Angle offset between intermediate and target object:  0.46306054522873197
goal dist:  0.07874346028537287
--------------------------------------------------
COST: 1.9787
STEP: 19
GOAL: True
target state:  [ 0.95 -0.1   0.  ]
Angle offset between intermediate and target object:  -0.31322043477862205
goal dist:  0.08179776801511705
--------------------------------------------------
COST: 1.1818
STEP: 11
GOAL: True
target state:  [ 0.95 -0.1   0.  ]
Angle offset between intermediate and target object:  -0.33302794982157
goal dist:  0.11333662586300941
--------------------------------------------------
COST: 1.3133
STEP: 12
GOAL: True
target state:  [ 0.95 -0.1   0.  ]
Angle offset between intermediate and target object:  -0.10256409604398688
goal dist:  0.09849473926956144
--------------------------------------------------
COST: 0.9985
STEP: 9
GOAL: True
MIN COST: 0.9985
PARAM: ['0.0535', '0.7159', '0.8855', '0.1215']
target state:  [ 0.95 -0.1   0.  ]
Angle offset between intermediate and target object:  0.0008404680008146166
goal dist:  0.15308386817731268
--------------------------------------------------
COST: 11.8531
STEP: 17
GOAL: False
target state:  [ 0.95 -0.1   0.  ]
Angle offset between intermediate and target object:  0.23763853554962022
detached, done with this trajectory
goal dist:  0.21061349024396045
--------------------------------------------------
COST: 10.9106
STEP: 7
GOAL: False
target state:  [ 0.95 -0.1   0.  ]
Angle offset between intermediate and target object:  -0.2381082590898191
goal dist:  0.09421319790298421
--------------------------------------------------
COST: 1.0942
STEP: 10
GOAL: True
target state:  [ 0.95 -0.1   0.  ]
Angle offset between intermediate and target object:  0.3863884051330104
goal dist:  0.14747626674872477
--------------------------------------------------
COST: 12.1475
STEP: 20
GOAL: False
target state:  [ 0.95 -0.1   0.  ]
Angle offset between intermediate and target object:  -0.17330129033559227
goal dist:  0.09863825703034743
--------------------------------------------------
COST: 1.2986
STEP: 12
GOAL: True
target state:  [ 0.95 -0.1   0.  ]
Angle offset between intermediate and target object:  0.2811743714388727
goal dist:  0.11304407396222095
--------------------------------------------------
COST: 1.5130
STEP: 14
GOAL: True
target state:  [ 0.95 -0.1   0.  ]
Angle offset between intermediate and target object:  0.0684196508369119
goal dist:  0.18171905717275041
--------------------------------------------------
COST: 11.9817
STEP: 18
GOAL: False
target state:  [ 0.95 -0.1   0.  ]
Angle offset between intermediate and target object:  -0.16334044575188317
goal dist:  0.1002166463401643
--------------------------------------------------
COST: 1.2002
STEP: 11
GOAL: True
target state:  [ 0.95 -0.1   0.  ]
Angle offset between intermediate and target object:  -0.06317683703222624
goal dist:  0.09754868620388261
--------------------------------------------------
COST: 1.0975
STEP: 10
GOAL: True
target state:  [ 0.95 -0.1   0.  ]
Angle offset between intermediate and target object:  -0.3147396213195272
goal dist:  0.08835528041238824
--------------------------------------------------
COST: 1.3884
STEP: 13
GOAL: True
target state:  [ 0.95 -0.1   0.  ]
Angle offset between intermediate and target object:  -0.053770379272618754
goal dist:  0.09544403633621998
--------------------------------------------------
COST: 1.3954
STEP: 13
GOAL: True
target state:  [ 0.95 -0.1   0.  ]
Angle offset between intermediate and target object:  -0.33132972144522727
goal dist:  0.09027535623363525
--------------------------------------------------
COST: 1.0903
STEP: 10
GOAL: True
target state:  [ 0.95 -0.1   0.  ]
Angle offset between intermediate and target object:  -0.24003909827702216
goal dist:  0.11087425804945074
--------------------------------------------------
COST: 1.6109
STEP: 15
GOAL: True
target state:  [ 0.95 -0.1   0.  ]
Angle offset between intermediate and target object:  -0.11508125959545659
goal dist:  0.08672314452640105
--------------------------------------------------
COST: 0.9867
STEP: 9
GOAL: True
MIN COST: 0.9867
PARAM: ['0.0535', '0.7159', '0.8855', '0.1215']
target state:  [ 0.95 -0.1   0.  ]
Angle offset between intermediate and target object:  -0.15733828225966773
goal dist:  0.08498026422808866
--------------------------------------------------
COST: 1.5850
STEP: 15
GOAL: True
target state:  [ 0.95 -0.1   0.  ]
Angle offset between intermediate and target object:  -0.34855188092292133
goal dist:  0.1048952418669258
--------------------------------------------------
COST: 1.1049
STEP: 10
GOAL: True
target state:  [ 0.95 -0.1   0.  ]
Angle offset between intermediate and target object:  -0.2486946243631974
goal dist:  0.09727985426198717
--------------------------------------------------
COST: 1.0973
STEP: 10
GOAL: True
target state:  [ 0.95 -0.1   0.  ]
Angle offset between intermediate and target object:  0.17292500556844384
goal dist:  0.09325955304498931
--------------------------------------------------
COST: 1.3933
STEP: 13
GOAL: True
target state:  [ 0.95 -0.1   0.  ]
Angle offset between intermediate and target object:  0.4219891755790936
detached, done with this trajectory
goal dist:  0.2924932449089614
--------------------------------------------------
COST: 11.2925
STEP: 10
GOAL: False
target state:  [ 0.95 -0.1   0.  ]
Angle offset between intermediate and target object:  0.22600832327901887
goal dist:  0.07925011238606011
--------------------------------------------------
COST: 1.2793
STEP: 12
GOAL: True
target state:  [ 0.95 -0.1   0.  ]
Angle offset between intermediate and target object:  0.4221702009926296
goal dist:  0.15327441872169034
--------------------------------------------------
COST: 12.7533
STEP: 26
GOAL: False
target state:  [ 0.95 -0.1   0.  ]
Angle offset between intermediate and target object:  -0.12498611761650123
goal dist:  0.09874296938229443
--------------------------------------------------
COST: 1.2987
STEP: 12
GOAL: True
target state:  [ 0.95 -0.1   0.  ]
Angle offset between intermediate and target object:  -0.5185565116554448
goal dist:  0.09642527216376613
--------------------------------------------------
COST: 1.3964
STEP: 13
GOAL: True
Cost Mean: 3.6147
Cost Variance: 18.9302
cost_mean 3.614724914722176
cost_var 18.93023158068162
(tensor) (base) yuzhou@Yuzhous-MacBook-Pro-8 bayesian_opt_multi_dynamic % 